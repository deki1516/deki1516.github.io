---
layout: post
title: "避免程序中的数学混淆"
categories: translations
---

纵观互联网，我们经常能够看到有帖子询问看似简单的数学问题，正确的答案是什么？而这些答案通常会引发成百上千的争论。例如以下数学问题，X 的值是多少？
```
X = 6 / 2(1+2)
```
虽然这个问题的答案很多，但结果通常集中在两个可能的答案上，`1` 和 `9`。当你查看人们在社交媒体上发布的答案时，你会发现大多数人使用了以下逻辑给出了`1` 的答案：
```
X = 6/2(1+2)
X = 6/2(3)
X = 6/6
X = 1
```
事实上，如果你在较旧的计算器中输入公式，你也可能会得到其他答案，如 Casio fx-82MS 所示：

![Casio计算的结果](/assets/images/blogs/2021-12-23_224423.png)

对于这个问题，只有一个答案是正确的，而且不是 1。按照今天的标准，Casio计算的结果是错误的！你可以通过使用你喜欢的编程语言（例如 Java）创建一个简单的程序来确认这一点：
``` java
public class SimpleMath {
    public static void main(String[] args) {
        double X = 6 / 2 * (1+2);
        System.out.println("X = " + X );
    }
}
```
运行时，该程序计算的结果如下：
```
X = 9
```
在过去，上述获得结果 1 的方式被认为是正确的。这是因为在做除法时，通常把右边的数字放在左边的下面。当你解决数学问题时，这样做很有意义，例如：

```
X = 6 / 2Y
```
那么它可以解释为： 
```
 6
———
 2Y
```

因此，如果 y 等于 (1+2)，则结果将为 1。然而，这不是今天计算机评估问题的方式。你可以用你最喜欢的编程语言再次测试它。我将再次使用 Java：
``` java
public class SimpleMath {
    public static void main(String[] args) {
        double y = 1+2;
        double x = 6 / 2*y;

        System.out.println("y = " + y );
        System.out.println("x = " + x );
    }
}
```
这次的输出是：

```
y = 3.0
x = 9.0
```
不同之处，就在于计算划分不再是以左边的所有数值除以右边的所有数值。相反，它适用的标准是运算符的优先级。这个顺序一般是BODMAS：

+ 括号
+ 阶数（指数、幂、平方根等）
+ 除法和乘法
+ 加减

公式中每一层的数字都是按从左到右的顺序计算的，因此，对于上面我们的问题，显然应该用` 6` 先除以 `2`，再乘以 `3（1+2 的结果）`，从而得出正确的答案`9`。

### 指数幂呢？
与之对应的是，幂的处理也可能被错误地评估。如果有一个指数为 4 的 3 次方的 2 次方的方程，结果会怎样：

![指数幂公式](/assets/images/blogs/2021-12-23_224900.png)


对于这个问题，也经常引用两种可能的答案,它们是 `4,096` 和 `262,144`，但哪个正确的呢？一段带有 JavaScript 代码HTML的可以帮助提供正确答案：

![指数幂计算过程](/assets/images/blogs/2021-12-23_225200.png)

如你所见，正确的结果是 `262,144`。截图下面的两个数字有助于说明指数运算并不是从左到右进行的，而是从右到左进行的。 

### 经验教训
理解公式的计算顺序是很重要的，记住上面我们提到的内容。还要记住，同一级别的计算顺序是从左到右。但是，指数幂的计算顺序，却是从右到左的。更重要的是，你要记住`括号`是你永远的朋友。如果你想消除计算公式求值顺序的不确定性，那么最好的方法是添加括号以消除混淆的部分。毕竟，`(6 / 2) * (1+2)`比`6/2 * (1+2)`更清晰，即使它们做的是同样的事情。


### 写在最后
计算机世界是现实世界的延伸，我们经常使用计算机帮助解决诸多现实问题。然而，计算机处理问题的本质，是基于众多规则而来，有些规则同常识一致，有些则不然。深入理解计算机的基本原理，可以帮助我们在编程中消除更多的不确定性。

[原文链接](https://www.developer.com/java/avoiding-math-confusion-in-your-programs/)